.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "BPSECRC 5"
.TH BPSECRC 5 "2020-09-24" "perl v5.16.3" "BP configuration files"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
bpsecrc \- BP security policy management commands file
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\s-1BP\s0 security policy management commands are passed to \fBbpsecadmin\fR either
in a file of text lines or interactively at \fBbpsecadmin\fR's command prompt
(:).  Commands are interpreted line-by line, with exactly one command per
line.  The formats and effects of the \s-1BP\s0 security policy management commands
are described below.
.PP
A parameter identifed as an \fIeid_expr\fR is an \*(L"endpoint \s-1ID\s0 expression.\*(R"  For
all commands, whenever the last character of an endpoint \s-1ID\s0 expression is
the wild-card character '*', an applicable endpoint \s-1ID \s0\*(L"matches\*(R" this \s-1EID\s0
expression if all characters of the endpoint \s-1ID\s0 expression prior to the last
one are equal to the corresponding characters of that endpoint \s-1ID. \s0 Otherwise
an applicable endpoint \s-1ID \s0\*(L"matches\*(R" the \s-1EID\s0 expression only when all characters
of the \s-1EID\s0 and \s-1EID\s0 expression are identical.
.PP
\&\s-1ION\s0 supports the proposed \*(L"streamlined\*(R" Bundle Security Protocol (currently
posted as \s-1CCSDS\s0 Red Book 734.5\-R\-1) in place of the standard Bundle Security
Protocol (\s-1RFC 6257\s0).  Since \s-1SBSP\s0 is not yet a published standard, \s-1ION\s0's
Bundle Protocol security mechanisms will not necessarily
interoperate with those of other \s-1BP\s0 implementations.  This is unfortunate but
(we hope) temporary, as \s-1SBSP\s0 represents a major improvement in bundle security.
It is possible that the \s-1SBSP\s0 specification will change somewhat between now
and the time \s-1SBSP\s0 is published as a \s-1CCSDS\s0 standard and eventually an \s-1RFC,\s0
and \s-1ION\s0 will be revised as necessary to conform to those changes, but in
the meantime we believe that the advantages of \s-1SBSP\s0 make it more suitable
than \s-1RFC 6257\s0 as a foundation for the development and deployment of secure
\&\s-1DTN\s0 applications.
.SH "COMMANDS"
.IX Header "COMMANDS"
.IP "\fB?\fR" 4
.IX Item "?"
The \fBhelp\fR command.  This will display a listing of the commands and their
formats.  It is the same as the \fBh\fR command.
.IP "\fB#\fR" 4
.IX Item "#"
Comment line.  Lines beginning with \fB#\fR are not interpreted.
.IP "\fBe\fR { 1 | 0 }" 4
.IX Item "e { 1 | 0 }"
Echo control.  Setting echo to 1 causes all output printed by bpsecadmin to
be logged as well as sent to stdout.  Setting echo to 0 disables this behavior.
.IP "\fBv\fR" 4
.IX Item "v"
Version number.  Prints out the version of \s-1ION\s0 currently installed.  \s-1HINT:\s0
combine with \fBe 1\fR command to log the version number at startup.
.IP "\fBa bspbibrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR \fI{ '' | ciphersuite_name key_name }\fR" 4
.IX Item "a bspbibrule source_eid_expr destination_eid_expr block_type_number { '' | ciphersuite_name key_name }"
The \fBadd bspbibrule\fR command.  This command adds a rule specifying the
manner in which Block Integrity Block (\s-1BIB\s0) validation will be applied
to blocks of type \fIblock_type_number\fR for all bundles sourced at any node
whose administrative endpoint \s-1ID\s0 matches \fIsource_eid_expr\fR and destined for
any node whose administrative endpoint \s-1ID ID\s0 matches \fIdestination_eid_expr\fR.
.Sp
If a zero-length string ('') is indicated instead of a \fIciphersuite_name\fR
then \s-1BIB\s0 validation is disabled for this source/destination \s-1EID\s0 expression
pair: blocks of the type indicated by \fIblock_type_number\fR in all
bundles sourced at nodes with matching administrative endpoint IDs and
destined for nodes with matching administrative endpoint IDs will be
immediately deemed valid.  Otherwise, a block of the indicated type that
is attached to a bundle sourced at a node with matching administrative
endpoint \s-1ID\s0 and destined for a node with matching administrative endpoint
\&\s-1ID\s0 will only be deemed valid if the bundle contains a corresponding \s-1BIB\s0
computed via the ciphersuite named by \fIciphersuite_name\fR using a key
value that is identical to the current value of the key named \fIkey_name\fR
in the local security policy database.
.IP "\fBc bspbibrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR \fI{ '' | ciphersuite_name key_name }\fR" 4
.IX Item "c bspbibrule source_eid_expr destination_eid_expr block_type_number { '' | ciphersuite_name key_name }"
The \fBchange bspbibrule\fR command.  This command changes the ciphersuite
name and/or key name for the \s-1BIB\s0 rule pertaining to the source/destination \s-1EID\s0
expression pair identified by \fIsource_eid_expr\fR and \fIdestination_eid_expr\fR
and the block identified by \fIblock_type_number\fR.
Note that the \fIeid_expr\fRs must exactly match those of the rule that is to
be modified, including any terminating wild-card character.
.IP "\fBd bspbibrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR" 4
.IX Item "d bspbibrule source_eid_expr destination_eid_expr block_type_number"
The \fBdelete bspbibrule\fR command.  This command deletes the \s-1BIB\s0 rule
pertaining to the source/destination \s-1EID\s0 expression pair identified by
\&\fIsender_eid_expr\fR and \fIreceiver_eid_expr\fR and the block identified by
\&\fIblock_type_number\fR.  Note that the \fIeid_expr\fRs
must exactly match those of the rule that is to be deleted, including any
terminating wild-card character.
.IP "\fBi bspbibrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR" 4
.IX Item "i bspbibrule source_eid_expr destination_eid_expr block_type_number"
This command will print information (the ciphersuite and key names) about the
\&\s-1BIB\s0 rule pertaining to \fIsource_eid_expr\fR, \fIdestination_eid_expr\fR, and
\&\fIblock_type_number\fR.
.IP "\fBl bspbibrule\fR" 4
.IX Item "l bspbibrule"
This command lists all \s-1BIB\s0 rules in the security policy database.
.IP "\fBa bspbcbrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR \fI{ '' | ciphersuite_name key_name }\fR" 4
.IX Item "a bspbcbrule source_eid_expr destination_eid_expr block_type_number { '' | ciphersuite_name key_name }"
The \fBadd bspbcbrule\fR command.  This command adds a rule specifying the
manner in which Block Confidentiality Block (\s-1BCB\s0) encryption will be applied
to blocks of type \fIblock_type_number\fR for all bundles sourced at any node
whose administrative endpoint \s-1ID\s0 matches \fIsource_eid_expr\fR and destined for
any node whose administrative endpoint \s-1ID ID\s0 matches \fIdestination_eid_expr\fR.
.Sp
If a zero-length string ('') is indicated instead of a \fIciphersuite_name\fR
then \s-1BCB\s0 encryption is disabled for this source/destination \s-1EID\s0 expression
pair: blocks of the type indicated by \fIblock_type_number\fR in all
bundles sourced at nodes with matching administrative endpoint IDs and
destined for nodes with matching administrative endpoint IDs will be
sent in plain text.  Otherwise, a block of the indicated type that
is attached to a bundle sourced at a node with matching administrative
endpoint \s-1ID\s0 and destined for a node with matching administrative endpoint
\&\s-1ID\s0 can only be deemed decrypted if the bundle contains a corresponding \s-1BCB\s0
computed via the ciphersuite named by \fIciphersuite_name\fR using a key
value that is identical to the current value of the key named \fIkey_name\fR
in the local security policy database.
.IP "\fBc bspbcbrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR \fI{ '' | ciphersuite_name key_name }\fR" 4
.IX Item "c bspbcbrule source_eid_expr destination_eid_expr block_type_number { '' | ciphersuite_name key_name }"
The \fBchange bspbcbrule\fR command.  This command changes the ciphersuite
name and/or key name for the \s-1BCB\s0 rule pertaining to the source/destination \s-1EID\s0
expression pair identified by \fIsource_eid_expr\fR and \fIdestination_eid_expr\fR
and the block identified by \fIblock_type_number\fR.
Note that the \fIeid_expr\fRs must exactly match those of the rule that is to
be modified, including any terminating wild-card character.
.IP "\fBd bspbcbrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR" 4
.IX Item "d bspbcbrule source_eid_expr destination_eid_expr block_type_number"
The \fBdelete bspbcbrule\fR command.  This command deletes the \s-1BCB\s0 rule
pertaining to the source/destination \s-1EID\s0 expression pair identified by
\&\fIsender_eid_expr\fR and \fIreceiver_eid_expr\fR and the block identified by
\&\fIblock_type_number\fR.  Note that the \fIeid_expr\fRs
must exactly match those of the rule that is to be deleted, including any
terminating wild-card character.
.IP "\fBi bspbcbrule\fR \fIsource_eid_expr\fR \fIdestination_eid_expr\fR \fIblock_type_number\fR" 4
.IX Item "i bspbcbrule source_eid_expr destination_eid_expr block_type_number"
This command will print information (the ciphersuite and key names) about the
\&\s-1BCB\s0 rule pertaining to \fIsource_eid_expr\fR, \fIdestination_eid_expr\fR, and
\&\fIblock_type_number\fR.
.IP "\fBl bspbcbrule\fR" 4
.IX Item "l bspbcbrule"
This command lists all \s-1BCB\s0 rules in the security policy database.
.IP "\fBx\fR \fI[ { ~ | sender_eid_expr } [ { ~ | receiver_eid_expr} [ { ~ | bib | bcb } ] ] ]\fR" 4
.IX Item "x [ { ~ | sender_eid_expr } [ { ~ | receiver_eid_expr} [ { ~ | bib | bcb } ] ] ]"
This command will clear all rules for the indicated type of bundle security
block between the indicated security source and security destination.  If
block type is omitted it defaults to \fB~\fR signifying \*(L"all \s-1SBSP\s0 blocks\*(R".  If
both block type and security destination are omitted, security destination
defaults to \fB~\fR signifying \*(L"all \s-1SBSP\s0 security destinations\*(R".  If all three
command-line parameters are omitted, then security source defaults to \fB~\fR
signifying \*(L"all \s-1SBSP\s0 security sources\*(R".
.IP "\fBh\fR" 4
.IX Item "h"
The \fBhelp\fR command.  This will display a listing of the commands and their
formats.  It is the same as the \fB?\fR command.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIbpsecadmin\fR\|(1)
