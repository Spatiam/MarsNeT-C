/*
 *
 * Copyright Antara Teknik LLC.  All rights reserved.
 *
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
 * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
 * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 *
 */


#include <stdint.h>
#include <stdlib.h>
#include <stdio.h>

#ifndef ERROR
#define ERROR (-1)
#endif

/* These tables are generated by the: 
 * Rocksoft^tm Model CRC Algorithm Table Generation Program V1.0
 */
/*****************************************************************/
/*                                                               */
/* CRC LOOKUP TABLE                                              */
/* ================                                              */
/*                                                               */
/*    Width   : 2 bytes.                                         */
/*    Poly    : 0x1021                                           */
/*    Reverse : TRUE.                                            */
/*                                                               */
/*****************************************************************/

static uint16_t crctable_1021_r[256] =
{
 0x0000, 0x1189, 0x2312, 0x329B, 0x4624, 0x57AD, 0x6536, 0x74BF,
 0x8C48, 0x9DC1, 0xAF5A, 0xBED3, 0xCA6C, 0xDBE5, 0xE97E, 0xF8F7,
 0x1081, 0x0108, 0x3393, 0x221A, 0x56A5, 0x472C, 0x75B7, 0x643E,
 0x9CC9, 0x8D40, 0xBFDB, 0xAE52, 0xDAED, 0xCB64, 0xF9FF, 0xE876,
 0x2102, 0x308B, 0x0210, 0x1399, 0x6726, 0x76AF, 0x4434, 0x55BD,
 0xAD4A, 0xBCC3, 0x8E58, 0x9FD1, 0xEB6E, 0xFAE7, 0xC87C, 0xD9F5,
 0x3183, 0x200A, 0x1291, 0x0318, 0x77A7, 0x662E, 0x54B5, 0x453C,
 0xBDCB, 0xAC42, 0x9ED9, 0x8F50, 0xFBEF, 0xEA66, 0xD8FD, 0xC974,
 0x4204, 0x538D, 0x6116, 0x709F, 0x0420, 0x15A9, 0x2732, 0x36BB,
 0xCE4C, 0xDFC5, 0xED5E, 0xFCD7, 0x8868, 0x99E1, 0xAB7A, 0xBAF3,
 0x5285, 0x430C, 0x7197, 0x601E, 0x14A1, 0x0528, 0x37B3, 0x263A,
 0xDECD, 0xCF44, 0xFDDF, 0xEC56, 0x98E9, 0x8960, 0xBBFB, 0xAA72,
 0x6306, 0x728F, 0x4014, 0x519D, 0x2522, 0x34AB, 0x0630, 0x17B9,
 0xEF4E, 0xFEC7, 0xCC5C, 0xDDD5, 0xA96A, 0xB8E3, 0x8A78, 0x9BF1,
 0x7387, 0x620E, 0x5095, 0x411C, 0x35A3, 0x242A, 0x16B1, 0x0738,
 0xFFCF, 0xEE46, 0xDCDD, 0xCD54, 0xB9EB, 0xA862, 0x9AF9, 0x8B70,
 0x8408, 0x9581, 0xA71A, 0xB693, 0xC22C, 0xD3A5, 0xE13E, 0xF0B7,
 0x0840, 0x19C9, 0x2B52, 0x3ADB, 0x4E64, 0x5FED, 0x6D76, 0x7CFF,
 0x9489, 0x8500, 0xB79B, 0xA612, 0xD2AD, 0xC324, 0xF1BF, 0xE036,
 0x18C1, 0x0948, 0x3BD3, 0x2A5A, 0x5EE5, 0x4F6C, 0x7DF7, 0x6C7E,
 0xA50A, 0xB483, 0x8618, 0x9791, 0xE32E, 0xF2A7, 0xC03C, 0xD1B5,
 0x2942, 0x38CB, 0x0A50, 0x1BD9, 0x6F66, 0x7EEF, 0x4C74, 0x5DFD,
 0xB58B, 0xA402, 0x9699, 0x8710, 0xF3AF, 0xE226, 0xD0BD, 0xC134,
 0x39C3, 0x284A, 0x1AD1, 0x0B58, 0x7FE7, 0x6E6E, 0x5CF5, 0x4D7C,
 0xC60C, 0xD785, 0xE51E, 0xF497, 0x8028, 0x91A1, 0xA33A, 0xB2B3,
 0x4A44, 0x5BCD, 0x6956, 0x78DF, 0x0C60, 0x1DE9, 0x2F72, 0x3EFB,
 0xD68D, 0xC704, 0xF59F, 0xE416, 0x90A9, 0x8120, 0xB3BB, 0xA232,
 0x5AC5, 0x4B4C, 0x79D7, 0x685E, 0x1CE1, 0x0D68, 0x3FF3, 0x2E7A,
 0xE70E, 0xF687, 0xC41C, 0xD595, 0xA12A, 0xB0A3, 0x8238, 0x93B1,
 0x6B46, 0x7ACF, 0x4854, 0x59DD, 0x2D62, 0x3CEB, 0x0E70, 0x1FF9,
 0xF78F, 0xE606, 0xD49D, 0xC514, 0xB1AB, 0xA022, 0x92B9, 0x8330,
 0x7BC7, 0x6A4E, 0x58D5, 0x495C, 0x3DE3, 0x2C6A, 0x1EF1, 0x0F78
};

#if (POLY_1EDC6F41_NEEDED)
/*****************************************************************/
/*                                                               */
/* CRC LOOKUP TABLE                                              */
/* ================                                              */
/*                                                               */
/*    Width   : 4 bytes.                                         */
/*    Poly    : 0x1EDC6F41L                                      */
/*    Reverse : FALSE.                                           */
/*                                                               */
/*****************************************************************/
//DTN ChecksumID # 3
static uint32_t  crctable_1EDC6F41[256] =
{
 0x00000000L, 0x1EDC6F41L, 0x3DB8DE82L, 0x2364B1C3L,
 0x7B71BD04L, 0x65ADD245L, 0x46C96386L, 0x58150CC7L,
 0xF6E37A08L, 0xE83F1549L, 0xCB5BA48AL, 0xD587CBCBL,
 0x8D92C70CL, 0x934EA84DL, 0xB02A198EL, 0xAEF676CFL,
 0xF31A9B51L, 0xEDC6F410L, 0xCEA245D3L, 0xD07E2A92L,
 0x886B2655L, 0x96B74914L, 0xB5D3F8D7L, 0xAB0F9796L,
 0x05F9E159L, 0x1B258E18L, 0x38413FDBL, 0x269D509AL,
 0x7E885C5DL, 0x6054331CL, 0x433082DFL, 0x5DECED9EL,
 0xF8E959E3L, 0xE63536A2L, 0xC5518761L, 0xDB8DE820L,
 0x8398E4E7L, 0x9D448BA6L, 0xBE203A65L, 0xA0FC5524L,
 0x0E0A23EBL, 0x10D64CAAL, 0x33B2FD69L, 0x2D6E9228L,
 0x757B9EEFL, 0x6BA7F1AEL, 0x48C3406DL, 0x561F2F2CL,
 0x0BF3C2B2L, 0x152FADF3L, 0x364B1C30L, 0x28977371L,
 0x70827FB6L, 0x6E5E10F7L, 0x4D3AA134L, 0x53E6CE75L,
 0xFD10B8BAL, 0xE3CCD7FBL, 0xC0A86638L, 0xDE740979L,
 0x866105BEL, 0x98BD6AFFL, 0xBBD9DB3CL, 0xA505B47DL,
 0xEF0EDC87L, 0xF1D2B3C6L, 0xD2B60205L, 0xCC6A6D44L,
 0x947F6183L, 0x8AA30EC2L, 0xA9C7BF01L, 0xB71BD040L,
 0x19EDA68FL, 0x0731C9CEL, 0x2455780DL, 0x3A89174CL,
 0x629C1B8BL, 0x7C4074CAL, 0x5F24C509L, 0x41F8AA48L,
 0x1C1447D6L, 0x02C82897L, 0x21AC9954L, 0x3F70F615L,
 0x6765FAD2L, 0x79B99593L, 0x5ADD2450L, 0x44014B11L,
 0xEAF73DDEL, 0xF42B529FL, 0xD74FE35CL, 0xC9938C1DL,
 0x918680DAL, 0x8F5AEF9BL, 0xAC3E5E58L, 0xB2E23119L,
 0x17E78564L, 0x093BEA25L, 0x2A5F5BE6L, 0x348334A7L,
 0x6C963860L, 0x724A5721L, 0x512EE6E2L, 0x4FF289A3L,
 0xE104FF6CL, 0xFFD8902DL, 0xDCBC21EEL, 0xC2604EAFL,
 0x9A754268L, 0x84A92D29L, 0xA7CD9CEAL, 0xB911F3ABL,
 0xE4FD1E35L, 0xFA217174L, 0xD945C0B7L, 0xC799AFF6L,
 0x9F8CA331L, 0x8150CC70L, 0xA2347DB3L, 0xBCE812F2L,
 0x121E643DL, 0x0CC20B7CL, 0x2FA6BABFL, 0x317AD5FEL,
 0x696FD939L, 0x77B3B678L, 0x54D707BBL, 0x4A0B68FAL,
 0xC0C1D64FL, 0xDE1DB90EL, 0xFD7908CDL, 0xE3A5678CL,
 0xBBB06B4BL, 0xA56C040AL, 0x8608B5C9L, 0x98D4DA88L,
 0x3622AC47L, 0x28FEC306L, 0x0B9A72C5L, 0x15461D84L,
 0x4D531143L, 0x538F7E02L, 0x70EBCFC1L, 0x6E37A080L,
 0x33DB4D1EL, 0x2D07225FL, 0x0E63939CL, 0x10BFFCDDL,
 0x48AAF01AL, 0x56769F5BL, 0x75122E98L, 0x6BCE41D9L,
 0xC5383716L, 0xDBE45857L, 0xF880E994L, 0xE65C86D5L,
 0xBE498A12L, 0xA095E553L, 0x83F15490L, 0x9D2D3BD1L,
 0x38288FACL, 0x26F4E0EDL, 0x0590512EL, 0x1B4C3E6FL,
 0x435932A8L, 0x5D855DE9L, 0x7EE1EC2AL, 0x603D836BL,
 0xCECBF5A4L, 0xD0179AE5L, 0xF3732B26L, 0xEDAF4467L,
 0xB5BA48A0L, 0xAB6627E1L, 0x88029622L, 0x96DEF963L,
 0xCB3214FDL, 0xD5EE7BBCL, 0xF68ACA7FL, 0xE856A53EL,
 0xB043A9F9L, 0xAE9FC6B8L, 0x8DFB777BL, 0x9327183AL,
 0x3DD16EF5L, 0x230D01B4L, 0x0069B077L, 0x1EB5DF36L,
 0x46A0D3F1L, 0x587CBCB0L, 0x7B180D73L, 0x65C46232L,
 0x2FCF0AC8L, 0x31136589L, 0x1277D44AL, 0x0CABBB0BL,
 0x54BEB7CCL, 0x4A62D88DL, 0x6906694EL, 0x77DA060FL,
 0xD92C70C0L, 0xC7F01F81L, 0xE494AE42L, 0xFA48C103L,
 0xA25DCDC4L, 0xBC81A285L, 0x9FE51346L, 0x81397C07L,
 0xDCD59199L, 0xC209FED8L, 0xE16D4F1BL, 0xFFB1205AL,
 0xA7A42C9DL, 0xB97843DCL, 0x9A1CF21FL, 0x84C09D5EL,
 0x2A36EB91L, 0x34EA84D0L, 0x178E3513L, 0x09525A52L,
 0x51475695L, 0x4F9B39D4L, 0x6CFF8817L, 0x7223E756L,
 0xD726532BL, 0xC9FA3C6AL, 0xEA9E8DA9L, 0xF442E2E8L,
 0xAC57EE2FL, 0xB28B816EL, 0x91EF30ADL, 0x8F335FECL,
 0x21C52923L, 0x3F194662L, 0x1C7DF7A1L, 0x02A198E0L,
 0x5AB49427L, 0x4468FB66L, 0x670C4AA5L, 0x79D025E4L,
 0x243CC87AL, 0x3AE0A73BL, 0x198416F8L, 0x075879B9L,
 0x5F4D757EL, 0x41911A3FL, 0x62F5ABFCL, 0x7C29C4BDL,
 0xD2DFB272L, 0xCC03DD33L, 0xEF676CF0L, 0xF1BB03B1L,
 0xA9AE0F76L, 0xB7726037L, 0x9416D1F4L, 0x8ACABEB5L
};
#endif


/*****************************************************************/
/*                                                               */
/* CRC LOOKUP TABLE                                              */
/* ================                                              */
/*                                                               */
/*    Width   : 4 bytes.                                         */
/*    Poly    : 0x04C11DB7L                                      */
/*    Reverse : FALSE.                                           */
/*                                                               */
/*                                                               */
/*****************************************************************/

static uint32_t  crctable_04C11DB7[256] =
{
 0x00000000L, 0x04C11DB7L, 0x09823B6EL, 0x0D4326D9L,
 0x130476DCL, 0x17C56B6BL, 0x1A864DB2L, 0x1E475005L,
 0x2608EDB8L, 0x22C9F00FL, 0x2F8AD6D6L, 0x2B4BCB61L,
 0x350C9B64L, 0x31CD86D3L, 0x3C8EA00AL, 0x384FBDBDL,
 0x4C11DB70L, 0x48D0C6C7L, 0x4593E01EL, 0x4152FDA9L,
 0x5F15ADACL, 0x5BD4B01BL, 0x569796C2L, 0x52568B75L,
 0x6A1936C8L, 0x6ED82B7FL, 0x639B0DA6L, 0x675A1011L,
 0x791D4014L, 0x7DDC5DA3L, 0x709F7B7AL, 0x745E66CDL,
 0x9823B6E0L, 0x9CE2AB57L, 0x91A18D8EL, 0x95609039L,
 0x8B27C03CL, 0x8FE6DD8BL, 0x82A5FB52L, 0x8664E6E5L,
 0xBE2B5B58L, 0xBAEA46EFL, 0xB7A96036L, 0xB3687D81L,
 0xAD2F2D84L, 0xA9EE3033L, 0xA4AD16EAL, 0xA06C0B5DL,
 0xD4326D90L, 0xD0F37027L, 0xDDB056FEL, 0xD9714B49L,
 0xC7361B4CL, 0xC3F706FBL, 0xCEB42022L, 0xCA753D95L,
 0xF23A8028L, 0xF6FB9D9FL, 0xFBB8BB46L, 0xFF79A6F1L,
 0xE13EF6F4L, 0xE5FFEB43L, 0xE8BCCD9AL, 0xEC7DD02DL,
 0x34867077L, 0x30476DC0L, 0x3D044B19L, 0x39C556AEL,
 0x278206ABL, 0x23431B1CL, 0x2E003DC5L, 0x2AC12072L,
 0x128E9DCFL, 0x164F8078L, 0x1B0CA6A1L, 0x1FCDBB16L,
 0x018AEB13L, 0x054BF6A4L, 0x0808D07DL, 0x0CC9CDCAL,
 0x7897AB07L, 0x7C56B6B0L, 0x71159069L, 0x75D48DDEL,
 0x6B93DDDBL, 0x6F52C06CL, 0x6211E6B5L, 0x66D0FB02L,
 0x5E9F46BFL, 0x5A5E5B08L, 0x571D7DD1L, 0x53DC6066L,
 0x4D9B3063L, 0x495A2DD4L, 0x44190B0DL, 0x40D816BAL,
 0xACA5C697L, 0xA864DB20L, 0xA527FDF9L, 0xA1E6E04EL,
 0xBFA1B04BL, 0xBB60ADFCL, 0xB6238B25L, 0xB2E29692L,
 0x8AAD2B2FL, 0x8E6C3698L, 0x832F1041L, 0x87EE0DF6L,
 0x99A95DF3L, 0x9D684044L, 0x902B669DL, 0x94EA7B2AL,
 0xE0B41DE7L, 0xE4750050L, 0xE9362689L, 0xEDF73B3EL,
 0xF3B06B3BL, 0xF771768CL, 0xFA325055L, 0xFEF34DE2L,
 0xC6BCF05FL, 0xC27DEDE8L, 0xCF3ECB31L, 0xCBFFD686L,
 0xD5B88683L, 0xD1799B34L, 0xDC3ABDEDL, 0xD8FBA05AL,
 0x690CE0EEL, 0x6DCDFD59L, 0x608EDB80L, 0x644FC637L,
 0x7A089632L, 0x7EC98B85L, 0x738AAD5CL, 0x774BB0EBL,
 0x4F040D56L, 0x4BC510E1L, 0x46863638L, 0x42472B8FL,
 0x5C007B8AL, 0x58C1663DL, 0x558240E4L, 0x51435D53L,
 0x251D3B9EL, 0x21DC2629L, 0x2C9F00F0L, 0x285E1D47L,
 0x36194D42L, 0x32D850F5L, 0x3F9B762CL, 0x3B5A6B9BL,
 0x0315D626L, 0x07D4CB91L, 0x0A97ED48L, 0x0E56F0FFL,
 0x1011A0FAL, 0x14D0BD4DL, 0x19939B94L, 0x1D528623L,
 0xF12F560EL, 0xF5EE4BB9L, 0xF8AD6D60L, 0xFC6C70D7L,
 0xE22B20D2L, 0xE6EA3D65L, 0xEBA91BBCL, 0xEF68060BL,
 0xD727BBB6L, 0xD3E6A601L, 0xDEA580D8L, 0xDA649D6FL,
 0xC423CD6AL, 0xC0E2D0DDL, 0xCDA1F604L, 0xC960EBB3L,
 0xBD3E8D7EL, 0xB9FF90C9L, 0xB4BCB610L, 0xB07DABA7L,
 0xAE3AFBA2L, 0xAAFBE615L, 0xA7B8C0CCL, 0xA379DD7BL,
 0x9B3660C6L, 0x9FF77D71L, 0x92B45BA8L, 0x9675461FL,
 0x8832161AL, 0x8CF30BADL, 0x81B02D74L, 0x857130C3L,
 0x5D8A9099L, 0x594B8D2EL, 0x5408ABF7L, 0x50C9B640L,
 0x4E8EE645L, 0x4A4FFBF2L, 0x470CDD2BL, 0x43CDC09CL,
 0x7B827D21L, 0x7F436096L, 0x7200464FL, 0x76C15BF8L,
 0x68860BFDL, 0x6C47164AL, 0x61043093L, 0x65C52D24L,
 0x119B4BE9L, 0x155A565EL, 0x18197087L, 0x1CD86D30L,
 0x029F3D35L, 0x065E2082L, 0x0B1D065BL, 0x0FDC1BECL,
 0x3793A651L, 0x3352BBE6L, 0x3E119D3FL, 0x3AD08088L,
 0x2497D08DL, 0x2056CD3AL, 0x2D15EBE3L, 0x29D4F654L,
 0xC5A92679L, 0xC1683BCEL, 0xCC2B1D17L, 0xC8EA00A0L,
 0xD6AD50A5L, 0xD26C4D12L, 0xDF2F6BCBL, 0xDBEE767CL,
 0xE3A1CBC1L, 0xE760D676L, 0xEA23F0AFL, 0xEEE2ED18L,
 0xF0A5BD1DL, 0xF464A0AAL, 0xF9278673L, 0xFDE69BC4L,
 0x89B8FD09L, 0x8D79E0BEL, 0x803AC667L, 0x84FBDBD0L,
 0x9ABC8BD5L, 0x9E7D9662L, 0x933EB0BBL, 0x97FFAD0CL,
 0xAFB010B1L, 0xAB710D06L, 0xA6322BDFL, 0xA2F33668L,
 0xBCB4666DL, 0xB8757BDAL, 0xB5365D03L, 0xB1F740B4L
};


/*****************************************************************/
/*                                                               */
/* CRC LOOKUP TABLE                                              */
/* ================                                              */
/*                                                               */
/*    Width   : 4 bytes.                                         */
/*    Poly    : 0x04C11DB7L                                      */
/*    Reverse : TRUE.                                            */
/*                                                               */
/*                                                               */
/*****************************************************************/

static uint32_t  crctable_04C11DB7_r[256] =
{
 0x00000000L, 0x77073096L, 0xEE0E612CL, 0x990951BAL,
 0x076DC419L, 0x706AF48FL, 0xE963A535L, 0x9E6495A3L,
 0x0EDB8832L, 0x79DCB8A4L, 0xE0D5E91EL, 0x97D2D988L,
 0x09B64C2BL, 0x7EB17CBDL, 0xE7B82D07L, 0x90BF1D91L,
 0x1DB71064L, 0x6AB020F2L, 0xF3B97148L, 0x84BE41DEL,
 0x1ADAD47DL, 0x6DDDE4EBL, 0xF4D4B551L, 0x83D385C7L,
 0x136C9856L, 0x646BA8C0L, 0xFD62F97AL, 0x8A65C9ECL,
 0x14015C4FL, 0x63066CD9L, 0xFA0F3D63L, 0x8D080DF5L,
 0x3B6E20C8L, 0x4C69105EL, 0xD56041E4L, 0xA2677172L,
 0x3C03E4D1L, 0x4B04D447L, 0xD20D85FDL, 0xA50AB56BL,
 0x35B5A8FAL, 0x42B2986CL, 0xDBBBC9D6L, 0xACBCF940L,
 0x32D86CE3L, 0x45DF5C75L, 0xDCD60DCFL, 0xABD13D59L,
 0x26D930ACL, 0x51DE003AL, 0xC8D75180L, 0xBFD06116L,
 0x21B4F4B5L, 0x56B3C423L, 0xCFBA9599L, 0xB8BDA50FL,
 0x2802B89EL, 0x5F058808L, 0xC60CD9B2L, 0xB10BE924L,
 0x2F6F7C87L, 0x58684C11L, 0xC1611DABL, 0xB6662D3DL,
 0x76DC4190L, 0x01DB7106L, 0x98D220BCL, 0xEFD5102AL,
 0x71B18589L, 0x06B6B51FL, 0x9FBFE4A5L, 0xE8B8D433L,
 0x7807C9A2L, 0x0F00F934L, 0x9609A88EL, 0xE10E9818L,
 0x7F6A0DBBL, 0x086D3D2DL, 0x91646C97L, 0xE6635C01L,
 0x6B6B51F4L, 0x1C6C6162L, 0x856530D8L, 0xF262004EL,
 0x6C0695EDL, 0x1B01A57BL, 0x8208F4C1L, 0xF50FC457L,
 0x65B0D9C6L, 0x12B7E950L, 0x8BBEB8EAL, 0xFCB9887CL,
 0x62DD1DDFL, 0x15DA2D49L, 0x8CD37CF3L, 0xFBD44C65L,
 0x4DB26158L, 0x3AB551CEL, 0xA3BC0074L, 0xD4BB30E2L,
 0x4ADFA541L, 0x3DD895D7L, 0xA4D1C46DL, 0xD3D6F4FBL,
 0x4369E96AL, 0x346ED9FCL, 0xAD678846L, 0xDA60B8D0L,
 0x44042D73L, 0x33031DE5L, 0xAA0A4C5FL, 0xDD0D7CC9L,
 0x5005713CL, 0x270241AAL, 0xBE0B1010L, 0xC90C2086L,
 0x5768B525L, 0x206F85B3L, 0xB966D409L, 0xCE61E49FL,
 0x5EDEF90EL, 0x29D9C998L, 0xB0D09822L, 0xC7D7A8B4L,
 0x59B33D17L, 0x2EB40D81L, 0xB7BD5C3BL, 0xC0BA6CADL,
 0xEDB88320L, 0x9ABFB3B6L, 0x03B6E20CL, 0x74B1D29AL,
 0xEAD54739L, 0x9DD277AFL, 0x04DB2615L, 0x73DC1683L,
 0xE3630B12L, 0x94643B84L, 0x0D6D6A3EL, 0x7A6A5AA8L,
 0xE40ECF0BL, 0x9309FF9DL, 0x0A00AE27L, 0x7D079EB1L,
 0xF00F9344L, 0x8708A3D2L, 0x1E01F268L, 0x6906C2FEL,
 0xF762575DL, 0x806567CBL, 0x196C3671L, 0x6E6B06E7L,
 0xFED41B76L, 0x89D32BE0L, 0x10DA7A5AL, 0x67DD4ACCL,
 0xF9B9DF6FL, 0x8EBEEFF9L, 0x17B7BE43L, 0x60B08ED5L,
 0xD6D6A3E8L, 0xA1D1937EL, 0x38D8C2C4L, 0x4FDFF252L,
 0xD1BB67F1L, 0xA6BC5767L, 0x3FB506DDL, 0x48B2364BL,
 0xD80D2BDAL, 0xAF0A1B4CL, 0x36034AF6L, 0x41047A60L,
 0xDF60EFC3L, 0xA867DF55L, 0x316E8EEFL, 0x4669BE79L,
 0xCB61B38CL, 0xBC66831AL, 0x256FD2A0L, 0x5268E236L,
 0xCC0C7795L, 0xBB0B4703L, 0x220216B9L, 0x5505262FL,
 0xC5BA3BBEL, 0xB2BD0B28L, 0x2BB45A92L, 0x5CB36A04L,
 0xC2D7FFA7L, 0xB5D0CF31L, 0x2CD99E8BL, 0x5BDEAE1DL,
 0x9B64C2B0L, 0xEC63F226L, 0x756AA39CL, 0x026D930AL,
 0x9C0906A9L, 0xEB0E363FL, 0x72076785L, 0x05005713L,
 0x95BF4A82L, 0xE2B87A14L, 0x7BB12BAEL, 0x0CB61B38L,
 0x92D28E9BL, 0xE5D5BE0DL, 0x7CDCEFB7L, 0x0BDBDF21L,
 0x86D3D2D4L, 0xF1D4E242L, 0x68DDB3F8L, 0x1FDA836EL,
 0x81BE16CDL, 0xF6B9265BL, 0x6FB077E1L, 0x18B74777L,
 0x88085AE6L, 0xFF0F6A70L, 0x66063BCAL, 0x11010B5CL,
 0x8F659EFFL, 0xF862AE69L, 0x616BFFD3L, 0x166CCF45L,
 0xA00AE278L, 0xD70DD2EEL, 0x4E048354L, 0x3903B3C2L,
 0xA7672661L, 0xD06016F7L, 0x4969474DL, 0x3E6E77DBL,
 0xAED16A4AL, 0xD9D65ADCL, 0x40DF0B66L, 0x37D83BF0L,
 0xA9BCAE53L, 0xDEBB9EC5L, 0x47B2CF7FL, 0x30B5FFE9L,
 0xBDBDF21CL, 0xCABAC28AL, 0x53B39330L, 0x24B4A3A6L,
 0xBAD03605L, 0xCDD70693L, 0x54DE5729L, 0x23D967BFL,
 0xB3667A2EL, 0xC4614AB8L, 0x5D681B02L, 0x2A6F2B94L,
 0xB40BBE37L, 0xC30C8EA1L, 0x5A05DF1BL, 0x2D02EF8DL
};


/*****************************************************************/
/*                                                               */
/* CRC LOOKUP TABLE                                              */
/* ================                                              */
/*                                                               */
/*    Width   : 4 bytes.                                         */
/*    Poly    : 0x1EDC6F41L                                      */
/*    Reverse : TRUE.                                            */
/*                                                               */
/*                                                               */
/*****************************************************************/

static uint32_t  crctable_1EDC6F41_r[256] =
{
 0x00000000L, 0xF26B8303L, 0xE13B70F7L, 0x1350F3F4L,
 0xC79A971FL, 0x35F1141CL, 0x26A1E7E8L, 0xD4CA64EBL,
 0x8AD958CFL, 0x78B2DBCCL, 0x6BE22838L, 0x9989AB3BL,
 0x4D43CFD0L, 0xBF284CD3L, 0xAC78BF27L, 0x5E133C24L,
 0x105EC76FL, 0xE235446CL, 0xF165B798L, 0x030E349BL,
 0xD7C45070L, 0x25AFD373L, 0x36FF2087L, 0xC494A384L,
 0x9A879FA0L, 0x68EC1CA3L, 0x7BBCEF57L, 0x89D76C54L,
 0x5D1D08BFL, 0xAF768BBCL, 0xBC267848L, 0x4E4DFB4BL,
 0x20BD8EDEL, 0xD2D60DDDL, 0xC186FE29L, 0x33ED7D2AL,
 0xE72719C1L, 0x154C9AC2L, 0x061C6936L, 0xF477EA35L,
 0xAA64D611L, 0x580F5512L, 0x4B5FA6E6L, 0xB93425E5L,
 0x6DFE410EL, 0x9F95C20DL, 0x8CC531F9L, 0x7EAEB2FAL,
 0x30E349B1L, 0xC288CAB2L, 0xD1D83946L, 0x23B3BA45L,
 0xF779DEAEL, 0x05125DADL, 0x1642AE59L, 0xE4292D5AL,
 0xBA3A117EL, 0x4851927DL, 0x5B016189L, 0xA96AE28AL,
 0x7DA08661L, 0x8FCB0562L, 0x9C9BF696L, 0x6EF07595L,
 0x417B1DBCL, 0xB3109EBFL, 0xA0406D4BL, 0x522BEE48L,
 0x86E18AA3L, 0x748A09A0L, 0x67DAFA54L, 0x95B17957L,
 0xCBA24573L, 0x39C9C670L, 0x2A993584L, 0xD8F2B687L,
 0x0C38D26CL, 0xFE53516FL, 0xED03A29BL, 0x1F682198L,
 0x5125DAD3L, 0xA34E59D0L, 0xB01EAA24L, 0x42752927L,
 0x96BF4DCCL, 0x64D4CECFL, 0x77843D3BL, 0x85EFBE38L,
 0xDBFC821CL, 0x2997011FL, 0x3AC7F2EBL, 0xC8AC71E8L,
 0x1C661503L, 0xEE0D9600L, 0xFD5D65F4L, 0x0F36E6F7L,
 0x61C69362L, 0x93AD1061L, 0x80FDE395L, 0x72966096L,
 0xA65C047DL, 0x5437877EL, 0x4767748AL, 0xB50CF789L,
 0xEB1FCBADL, 0x197448AEL, 0x0A24BB5AL, 0xF84F3859L,
 0x2C855CB2L, 0xDEEEDFB1L, 0xCDBE2C45L, 0x3FD5AF46L,
 0x7198540DL, 0x83F3D70EL, 0x90A324FAL, 0x62C8A7F9L,
 0xB602C312L, 0x44694011L, 0x5739B3E5L, 0xA55230E6L,
 0xFB410CC2L, 0x092A8FC1L, 0x1A7A7C35L, 0xE811FF36L,
 0x3CDB9BDDL, 0xCEB018DEL, 0xDDE0EB2AL, 0x2F8B6829L,
 0x82F63B78L, 0x709DB87BL, 0x63CD4B8FL, 0x91A6C88CL,
 0x456CAC67L, 0xB7072F64L, 0xA457DC90L, 0x563C5F93L,
 0x082F63B7L, 0xFA44E0B4L, 0xE9141340L, 0x1B7F9043L,
 0xCFB5F4A8L, 0x3DDE77ABL, 0x2E8E845FL, 0xDCE5075CL,
 0x92A8FC17L, 0x60C37F14L, 0x73938CE0L, 0x81F80FE3L,
 0x55326B08L, 0xA759E80BL, 0xB4091BFFL, 0x466298FCL,
 0x1871A4D8L, 0xEA1A27DBL, 0xF94AD42FL, 0x0B21572CL,
 0xDFEB33C7L, 0x2D80B0C4L, 0x3ED04330L, 0xCCBBC033L,
 0xA24BB5A6L, 0x502036A5L, 0x4370C551L, 0xB11B4652L,
 0x65D122B9L, 0x97BAA1BAL, 0x84EA524EL, 0x7681D14DL,
 0x2892ED69L, 0xDAF96E6AL, 0xC9A99D9EL, 0x3BC21E9DL,
 0xEF087A76L, 0x1D63F975L, 0x0E330A81L, 0xFC588982L,
 0xB21572C9L, 0x407EF1CAL, 0x532E023EL, 0xA145813DL,
 0x758FE5D6L, 0x87E466D5L, 0x94B49521L, 0x66DF1622L,
 0x38CC2A06L, 0xCAA7A905L, 0xD9F75AF1L, 0x2B9CD9F2L,
 0xFF56BD19L, 0x0D3D3E1AL, 0x1E6DCDEEL, 0xEC064EEDL,
 0xC38D26C4L, 0x31E6A5C7L, 0x22B65633L, 0xD0DDD530L,
 0x0417B1DBL, 0xF67C32D8L, 0xE52CC12CL, 0x1747422FL,
 0x49547E0BL, 0xBB3FFD08L, 0xA86F0EFCL, 0x5A048DFFL,
 0x8ECEE914L, 0x7CA56A17L, 0x6FF599E3L, 0x9D9E1AE0L,
 0xD3D3E1ABL, 0x21B862A8L, 0x32E8915CL, 0xC083125FL,
 0x144976B4L, 0xE622F5B7L, 0xF5720643L, 0x07198540L,
 0x590AB964L, 0xAB613A67L, 0xB831C993L, 0x4A5A4A90L,
 0x9E902E7BL, 0x6CFBAD78L, 0x7FAB5E8CL, 0x8DC0DD8FL,
 0xE330A81AL, 0x115B2B19L, 0x020BD8EDL, 0xF0605BEEL,
 0x24AA3F05L, 0xD6C1BC06L, 0xC5914FF2L, 0x37FACCF1L,
 0x69E9F0D5L, 0x9B8273D6L, 0x88D28022L, 0x7AB90321L,
 0xAE7367CAL, 0x5C18E4C9L, 0x4F48173DL, 0xBD23943EL,
 0xF36E6F75L, 0x0105EC76L, 0x12551F82L, 0xE03E9C81L,
 0x34F4F86AL, 0xC69F7B69L, 0xD5CF889DL, 0x27A40B9EL,
 0x79B737BAL, 0x8BDCB4B9L, 0x988C474DL, 0x6AE7C44EL,
 0xBE2DA0A5L, 0x4C4623A6L, 0x5F16D052L, 0xAD7D5351L
};

/*****************************************************************/
/*                   End of CRC Lookup Tables                    */
/*****************************************************************/

/******************************************************************************
 *
 * \par Function Name: ion_CRC16_1021_X25
 *
 * \par Purpose: Calculate the CRC16 value for poly 0x1021.
 *
 * \retval      CRC Value
 *
 * \param[in]   data  Pointer to the data block
 * \param[in]   dLen  Length of data block in bytes
 * \param[in]   crc   Initial CRC (0 for the first time; or previous crc if
 *                    accumulating)
 * \par Notes:
 *      1. ALIASES: CRC-16/ISO-HDLC, CRC-16/X-25, X-25
 *      2. This function utilizes the table crctable_04C11DB7.
 *      3. Data is reflected.
 *      4. crc type must be unsigned.
 *      5. init = 0xffff xorout = 0xffff
 *      6. check = 0x9063 (for input "123456789")
 *****************************************************************************/
uint16_t ion_CRC16_1021_X25(const char *data, uint32_t dLen, uint16_t crc)
{
    if(data == NULL)
        return ERROR;
        
    uint16_t lcrc = ~crc;
    uint8_t  i;

    while(dLen--)
    {
        i = (lcrc & 0xFFL) ^ *data;	/*	No negative subscript!	*/
        lcrc = (lcrc >> 8) ^ crctable_1021_r[i];
	data++;
    }
    
    return ~lcrc;      //lcrc ^ xorout, where xorout = 0xffffffff    
} 
 
/******************************************************************************
 *
 * \par Function Name: ion_CRC32_04C11DB7_bzip2
 *
 * \par Purpose: Calculate the bzip2 CRC32 value for poly 0x04C11DB7.
 *
 * \retval      CRC Value
 *
 * \param[in]   data  Pointer to the data block
 * \param[in]   dLen  Length of data block in bytes
 * \param[in]   crc   Initial CRC (0 for the first time; or previous crc if
 *                    accumulating)
 *
 * \par Notes:
 *      1. ALIASES: CRC-32/BZIP2, B-CRC-32
 *      2. This function utilizes the table crctable_04C11DB7.
 *      3. Data is not reflected
 *      4. init = 0xffffffff xorout = 0xffffffff
 *      5. check = 0xfc891918 (for input "123456789")
 *****************************************************************************/ 
uint32_t ion_CRC32_04C11DB7_bzip2(const char *data, uint32_t dLen, uint32_t crc)
{
    if(data == NULL)
        return ERROR;

    uint32_t lcrc = ~crc;
    uint8_t  i;

    while(dLen--)
    {
        i = ((lcrc >> 24) ^ *data) & 0xFFL;
        lcrc = (lcrc << 8) ^ crctable_04C11DB7[i];
	data++;
    }
        
    return ~lcrc;      //lcrc ^ xorout, where xorout = 0xffffffff  
}

/******************************************************************************
 *
 * \par Function Name: ion_CRC32_04C11DB7
 *
 * \par Purpose: Calculate the ISO-HDLC CRC32 value for poly 0x04C11DB7.
 *
 * \retval      CRC Value
 *
 * \param[in]   data  Pointer to the data block
 * \param[in]   dLen  Length of data block in bytes
 * \param[in]   crc   Initial CRC (0 for the first time; or previous crc if
 *                    accumulating)
 *
 * \par Notes:
 *      1. ALIASES: CRC-32, CRC-32/ISO-HDLC
 *      2. This function utilizes the table crctable_04C11DB7.
 *      3. Data is reflected
 *      4. crc type must be unsigned.
 *      5. init = 0xffffffff xorout = 0xffffffff
 *      6. check = 0xcbf43926 (for input "123456789")
 *****************************************************************************/ 
uint32_t ion_CRC32_04C11DB7(const char *data, uint32_t dLen, uint32_t crc)
{
    if(data == NULL)
        return ERROR;

    uint32_t lcrc = ~crc;
    uint8_t  i;

    while(dLen--)
    {
        i = (lcrc & 0xFFL) ^ *data;
        lcrc = (lcrc >> 8) ^ crctable_04C11DB7_r[i];
	data++;
    }
        
    return ~lcrc;     //lcrc ^ xorout, where xorout = 0xffffffff  
}

/******************************************************************************
 *
 * \par Function Name: ion_CRC32_1EDC6F41_C
 *
 * \par Purpose: Calculate the CRC32C value for poly 0x1EDC6F41.
 *
 * \retval      CRC Value
 *
 * \param[in]   data  Pointer to the data block
 * \param[in]   dLen  Length of data block in bytes
 * \param[in]   crc   Initial CRC (0 for the first time; or previous crc if
 *                    accumulating)
 *
 * \par Notes:
 *      1. ALIASES: CRC-32/CASTAGNOLI, CRC-32/C, CRC-32/ISCSI
 *      2. This function utilizes the table crctable_1EDC6F41.
 *      3. Data is reflected
 *      4. crc type must be unsigned.
 *      5. init = 0xffffffff xorout = 0xffffffff
 *      6. check = 0xe3069283 (for input "123456789")
 *****************************************************************************/ 
uint32_t ion_CRC32_1EDC6F41_C(const char *data, uint32_t dLen, uint32_t crc)
{
    if(data == NULL)
        return ERROR;
        
    uint32_t lcrc = ~crc;
    uint8_t  i;

    while(dLen--)
    {
        i = (lcrc & 0xFFL) ^ *data;
        lcrc = (lcrc >> 8) ^ crctable_1EDC6F41_r[i];
	data++;
    }
    
    return ~lcrc;      //lcrc ^ xorout, where xorout = 0xffffffff    
}

